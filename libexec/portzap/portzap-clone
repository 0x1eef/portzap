#!/bin/sh -e

##
# variables
localbase=${LOCALBASE:-/usr/local}
git="${localbase}"/bin/git
giturl=$1
gitdir=$2
branch=$3

##
# main
if [ -e "${gitdir}/.git" ]; then
    echo "[-] ${gitdir} exists."
    echo "[-] Try 'portzap pull'"
    exit 1
fi
set -x
umask u=rwX,g=rwX,o=
"${git}" clone "${giturl}" "${gitdir}"
cd "${gitdir}"
set +x +e
echo "[-] Checkout ${branch}"
"${git}" checkout -t origin/"${branch}" > /dev/null 2>&1;
echo "[-] Done"
